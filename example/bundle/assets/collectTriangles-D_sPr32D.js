import{M as L,l as H,J as N,W as P,c as G,d as I,D as j,A as F,T as U,B as V,u as X,g as D,e as Y,P as k,m as O,q,K,V as J}from"./ExtendedTriangle-CFC-kWKu.js";import{S as Z}from"./Stats-9dH8FB2H.js";import{g as _}from"./lil-gui.module.min-jESndyO-.js";import{O as Q}from"./OrbitControls-DPxOa-V_.js";import{I as W,a as $,N as ee}from"./MeshBVH-CE-cOGaL.js";import{a as te,b as ne,e as oe}from"./ExtensionUtilities-DtfWnSqQ.js";L.prototype.raycast=te;H.prototype.computeBoundsTree=ne;H.prototype.disposeBoundsTree=oe;const d={size:.1,rotate:!0};let C,w,o,s,m,l,c,y=new N,x=-1,M=!1,B;function re(){s=new P({antialias:!0}),s.setPixelRatio(window.devicePixelRatio),s.setSize(window.innerWidth,window.innerHeight),s.setClearColor(1251612,1),document.body.appendChild(s.domElement),s.domElement.style.touchAction="none",w=new G,w.fog=new I(2503224/2,20,60);const E=new j(16777215,1.5);E.position.set(1,1,1),w.add(E),w.add(new F(16777215,1.2));const p=1,S=.4,T=800,u=400,h=new U(p,S,T,u).toNonIndexed(),g=new Uint8Array(h.attributes.position.count*3);g.fill(255);const a=new V(g,3,!0);a.setUsage(X),h.setAttribute("color",a);const b=new D({color:16777215,roughness:.3,metalness:0,vertexColors:!0});l=new L(h,b),l.geometry.computeBoundsTree(),w.add(l);const A=new Y(1,40,40),r=new D({color:15483002,roughness:.75,metalness:0,transparent:!0,opacity:.5,premultipliedAlpha:!0,emissive:15483002,emissiveIntensity:.5});c=new L(A,r),w.add(c),o=new k(75,window.innerWidth/window.innerHeight,.1,50),o.position.set(3,3,3),o.far=100,o.updateProjectionMatrix(),C=new Z,document.body.appendChild(C.dom);const n=new _;n.add(d,"size").min(.1).max(1).step(.1),n.add(d,"rotate"),n.open(),window.addEventListener("resize",function(){o.aspect=window.innerWidth/window.innerHeight,o.updateProjectionMatrix(),s.setSize(window.innerWidth,window.innerHeight)},!1),window.addEventListener("pointermove",function(e){y.x=e.clientX/window.innerWidth*2-1,y.y=-(e.clientY/window.innerHeight)*2+1,M=!0}),window.addEventListener("pointerdown",function(e){y.x=e.clientX/window.innerWidth*2-1,y.y=-(e.clientY/window.innerHeight)*2+1,x=e.button;const t=new O;t.setFromCamera(y,o),t.firstHitOnly=!0;const i=t.intersectObject(l,!0);M=!0,m.enabled=i.length===0},!0),window.addEventListener("pointerup",function(e){x=-1,e.pointerType==="touch"&&(M=!1)},!0),window.addEventListener("contextmenu",function(e){e.preventDefault()}),window.addEventListener("wheel",function(e){let t=e.deltaY;e.deltaMode===1&&(t*=40),e.deltaMode===2&&(t*=40),d.size+=t*5e-4,d.size=Math.max(Math.min(d.size,1),.1),n.controllersRecursive().forEach(i=>i.updateDisplay())}),m=new Q(o,s.domElement),m.addEventListener("start",function(){this.active=!0}),m.addEventListener("end",function(){this.active=!1}),B=window.performance.now()}function R(){requestAnimationFrame(R),C.begin();const v=l.geometry,E=v.boundsTree,p=v.getAttribute("color"),S=v.index;if(m.active||!M)c.visible=!1;else{c.scale.setScalar(d.size);const u=new O;u.setFromCamera(y,o),u.firstHitOnly=!0;const h=u.intersectObject(l,!0);if(h.length){c.position.copy(h[0].point),m.enabled=!1,c.visible=!0;const g=new q;g.copy(l.matrixWorld).invert();const a=new K;a.center.copy(c.position).applyMatrix4(g),a.radius=d.size;const b=[],A=new J;if(E.shapecast({intersectsBounds:r=>{const n=a.intersectsBox(r),{min:e,max:t}=r;if(n){for(let i=0;i<=1;i++)for(let f=0;f<=1;f++)for(let z=0;z<=1;z++)if(A.set(i===0?e.x:t.x,f===0?e.y:t.y,z===0?e.z:t.z),!a.containsPoint(A))return W;return $}return n?W:ee},intersectsTriangle:(r,n,e)=>{if(e||r.intersectsSphere(a)){const t=3*n;b.push(t,t+1,t+2)}return!1}}),x===0||x===2){let r=1,n=1,e=1;x===0&&(r=15/255,n=78/255,e=85/255);for(let t=0,i=b.length;t<i;t++){const f=S.getX(b[t]);p.setX(f,r),p.setY(f,n),p.setZ(f,e)}p.needsUpdate=!0}}else m.enabled=!0,c.visible=!1}const T=window.performance.now();if(d.rotate){const u=T-B;l.rotation.y+=u*.001}B=T,s.render(w,o),C.end()}re();R();
